-- Business Questions for Exploratory Data Analysis

-- Product Questions

-- 1. What are the unique product lines in the dataset?
SELECT DISTINCT
    product_line
FROM
    sales;

SELECT 
    COUNT(DISTINCT product_line) AS total_unique_product
FROM
    sales;
-- Answer: The dataset contains 6 unique product lines.

-- 2. What is the distribution of payment methods used?
SELECT 
    payment_method,
    COUNT(payment_method) AS total_payment_method
FROM
    sales
GROUP BY payment_method
ORDER BY total_payment_method DESC;
-- Answer: The most common payment method is cash.

-- 3. Which product line has the highest sales quantity?
SELECT 
    product_line, COUNT(quantity) AS total_quantity
FROM
    sales
GROUP BY product_line
ORDER BY total_quantity DESC;
-- Answer: The most sold product line is "Fashion Accessories" with 178 sales.

-- 4. What is the total revenue generated by each month?
SELECT 
    month_name, SUM(total) AS total_revenue
FROM
    sales
GROUP BY month_name
ORDER BY total_revenue DESC;
-- Answer: The total revenue by month is as follows: January = 116,292.11, March = 108,867.38, February = 95,727.58, with January having the highest total revenue.

-- 5. Which month had the largest Cost of Goods Sold (COGS)?
SELECT 
    month_name, SUM(cogs) AS total_cogs
FROM
    sales
GROUP BY month_name
ORDER BY total_cogs DESC;
-- Answer: January had the largest COGS at 110,754.16.

-- 6. Which product line generated the highest revenue?
SELECT 
    product_line, SUM(total) AS total_revenue
FROM
    sales
GROUP BY product_line
ORDER BY total_revenue DESC;
-- Answer: "Food and Beverages" had the highest revenue.

-- 7. Which city has the largest total revenue?
SELECT 
    branch, city, SUM(total) AS total_revenue
FROM
    sales
GROUP BY city, branch
ORDER BY total_revenue DESC;
-- Answer: Naypyitaw is the city with the largest total revenue.

-- 8. Which product line incurred the highest VAT?
SELECT 
    product_line, MAX(VAT) AS max_VAT
FROM
    sales
GROUP BY product_line
ORDER BY max_VAT DESC;
-- Answer: "Fashion Accessories" had the largest VAT at 49.65.

-- 9. How do product lines compare to the average sales?
SELECT 
    product_line,
    CASE
        WHEN AVG(total) > (SELECT AVG(total) FROM sales)
        THEN 'Good'
        ELSE 'Bad'
    END AS total_product
FROM
    sales
GROUP BY product_line;
-- Answer: "Food and Beverages," "Health and Beauty," "Sports and Travel," and "Home and Lifestyle" have good sales; however, "Fashion Accessories" and "Electronic Accessories" have bad sales.

-- 10. Which branches sold more products than the average?
SELECT 
    branch, SUM(quantity)
FROM
    sales
GROUP BY branch;

SELECT 
    AVG(quantity)
FROM
    (SELECT 
        branch, SUM(quantity)
    FROM
        sales
    GROUP BY branch) AS total_avg;

SELECT 
    branch, SUM(quantity)
FROM
    sales
GROUP BY branch
HAVING SUM(quantity) > (SELECT 
        AVG(quantity)
    FROM
        (SELECT 
            branch, SUM(quantity)
        FROM
            sales
        GROUP BY branch) AS avg_total);
-- Answer: Branches A and C sold more products than the average.

-- 11. What is the most common product line by gender?
SELECT 
    gender, COUNT(product_line), MAX(product_line)
FROM
    sales
GROUP BY gender, product_line
ORDER BY COUNT(product_line) DESC;
-- Answer: The most common product line for females is "Fashion Accessories," while for males, it is "Health and Beauty."

-- 12. What is the average rating of each product line?
SELECT 
    product_line, ROUND(AVG(rating), 2)
FROM
    sales
GROUP BY product_line
ORDER BY AVG(rating) DESC;
-- Answer: The average ratings are as follows: "Food and Beverages" = 7.11, "Fashion Accessories" = 7.03, "Health and Beauty" = 6.98, "Electronic Accessories" = 6.91, "Sports and Travel" = 6.86, and "Home and Lifestyle" = 6.84.
